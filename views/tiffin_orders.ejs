<div class="page-header">
	<h1>üç± Tiffin Orders Management</h1>
	<p>Manage all daily tiffin orders for patients</p>
</div>

<div class="action-bar">
	<a href="/receptionist/tiffin-orders/new" class="btn btn-primary">+ New Tiffin Order</a>
	<a href="/dashboard" class="btn btn-secondary">‚Üê Back to Dashboard</a>
</div>

<div class="filters">
	<form method="get" action="/receptionist/tiffin-orders" class="filter-form">
		<select name="status" onchange="this.form.submit()">
			<option value="">All Status</option>
			<option value="pending" <%= filter.status === 'pending' ? 'selected' : '' %>>Pending</option>
			<option value="confirmed" <%= filter.status === 'confirmed' ? 'selected' : '' %>>Confirmed</option>
			<option value="preparing" <%= filter.status === 'preparing' ? 'selected' : '' %>>Preparing</option>
			<option value="ready" <%= filter.status === 'ready' ? 'selected' : '' %>>Ready</option>
			<option value="delivered" <%= filter.status === 'delivered' ? 'selected' : '' %>>Delivered</option>
			<option value="cancelled" <%= filter.status === 'cancelled' ? 'selected' : '' %>>Cancelled</option>
		</select>
		
		<select name="ward" onchange="this.form.submit()">
			<option value="">All Wards</option>
			<option value="Ward A" <%= filter.ward === 'Ward A' ? 'selected' : '' %>>Ward A</option>
			<option value="Ward B" <%= filter.ward === 'Ward B' ? 'selected' : '' %>>Ward B</option>
			<option value="Ward C" <%= filter.ward === 'Ward C' ? 'selected' : '' %>>Ward C</option>
			<option value="ICU" <%= filter.ward === 'ICU' ? 'selected' : '' %>>ICU</option>
		</select>
		
		<input type="date" name="orderDate" value="<%= filter.orderDate || '' %>" onchange="this.form.submit()" placeholder="Filter by date">
		
		<button type="button" onclick="this.form.reset(); this.form.submit();" class="btn btn-outline">Clear Filters</button>
	</form>
</div>

<% if (orders.length === 0) { %>
	<div class="empty-state">
		<p>No tiffin orders found matching your criteria.</p>
		<a href="/receptionist/tiffin-orders/new" class="btn btn-primary">Create New Order</a>
	</div>
<% } else { %>
	<div class="orders-table-container">
		<table class="orders-table">
			<thead>
				<tr>
					<th>Patient Name</th>
					<th>Ward</th>
					<th>Food Type</th>
					<th>Quantity</th>
					<th>Order Date</th>
					<th>Status</th>
					<th>Notes</th>
					<th>Created</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				<% orders.forEach(order => { %>
					<tr>
						<td><strong><%= order.patient_name %></strong></td>
						<td><%= order.ward %></td>
						<td><%= order.food_type %></td>
						<td><%= order.quantity %></td>
						<td><%= dayjs(order.order_date).format('MMM DD, YYYY') %></td>
						<td>
							<span class="status-badge status-<%= order.status %>"><%= order.status %></span>
						</td>
						<td><%= order.notes || '-' %></td>
						<td><%= dayjs(order.created_at).format('MMM DD, HH:mm') %></td>
						<td>
							<div class="action-buttons">
								<a href="/receptionist/tiffin-orders/<%= order.id %>/edit" class="btn btn-sm btn-secondary">Edit</a>
								<form method="post" action="/receptionist/tiffin-orders/<%= order.id %>/delete" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this order?')">
									<button type="submit" class="btn btn-sm btn-danger">Delete</button>
								</form>
							</div>
						</td>
					</tr>
				<% }) %>
			</tbody>
		</table>
	</div>
<% } %>

<style>
.action-bar {
	display: flex;
	gap: 1rem;
	margin-bottom: 2rem;
}

.filters {
	background: #f8f9fa;
	padding: 1rem;
	border-radius: 8px;
	margin-bottom: 2rem;
}

.filter-form {
	display: flex;
	gap: 1rem;
	align-items: center;
	flex-wrap: wrap;
}

.filter-form select,
.filter-form input {
	padding: 0.5rem;
	border: 1px solid #ced4da;
	border-radius: 4px;
	min-width: 150px;
}

.orders-table-container {
	overflow-x: auto;
	background: white;
	border-radius: 8px;
	box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.orders-table {
	width: 100%;
	border-collapse: collapse;
}

.orders-table th,
.orders-table td {
	padding: 1rem;
	text-align: left;
	border-bottom: 1px solid #e9ecef;
}

.orders-table th {
	background: #f8f9fa;
	font-weight: 600;
	color: #495057;
}

.orders-table tbody tr:hover {
	background: #f8f9fa;
}

.status-badge {
	padding: 0.25rem 0.5rem;
	border-radius: 4px;
	font-size: 0.8rem;
	font-weight: bold;
	text-transform: uppercase;
}

.status-pending { background: #fff3cd; color: #856404; }
.status-confirmed { background: #d1ecf1; color: #0c5460; }
.status-preparing { background: #f8d7da; color: #721c24; }
.status-ready { background: #d4edda; color: #155724; }
.status-delivered { background: #d1ecf1; color: #0c5460; }
.status-cancelled { background: #f8d7da; color: #721c24; }

.action-buttons {
	display: flex;
	gap: 0.5rem;
}

.empty-state {
	text-align: center;
	padding: 3rem;
	color: #6c757d;
}

.empty-state a {
	margin-top: 1rem;
	display: inline-block;
}

@media (max-width: 768px) {
	.filter-form {
		flex-direction: column;
		align-items: stretch;
	}
	
	.filter-form select,
	.filter-form input {
		min-width: auto;
	}
	
	.orders-table {
		font-size: 0.9rem;
	}
	
	.orders-table th,
	.orders-table td {
		padding: 0.5rem;
	}
}
</style>


